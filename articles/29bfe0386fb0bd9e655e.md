---
title: "SalesForceã®Refresh Tokenå–å¾—æ–¹æ³•"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['SalesForce', 'OAuth']
published: true
---
## æ¦‚è¦
SalesForceã§refresh_tokenã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ãŸãŒã€ãƒãƒã£ã¦ã—ã¾ã£ãŸãŸã‚è¨˜äº‹ã¨ã—ã¦æ®‹ã—ã¦ãŠãã€‚
ãŸã¶ã‚“ã“ã®è¨˜äº‹ã«è¾¿ã‚Šç€ãäººã¯SalesForceã®ã€Œ[æ›´æ–°ãƒˆãƒ¼ã‚¯ãƒ³ãƒ•ãƒ­ãƒ¼](https://help.salesforce.com/articleView?id=remoteaccess_oauth_refresh_token_flow.htm&type=5)ã€ã‚’èª­ã‚“ã§ã€çµå±€ã©ã†ã‚„ã£ã¦å–å¾—ã™ã‚“ã­ã‚“ã£ã¦ãªã£ãŸäººã§ã¯ãªã„ã ã‚ã†ã‹ãƒ»ãƒ»ãƒ»ã€‚

## çµè«–
webã‚µãƒ¼ãƒèªè¨¼ãƒ•ãƒ­ãƒ¼ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§å–å¾—ã§ãã‚‹
â€» åˆ©ç”¨ã—ã¦ã„ã‚‹APIã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯v47.0ã§ã™

## æ‰‹é †
### SalesForceå´ã§æ¥ç¶šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šã‚’ã™ã‚‹
1. SalesForceã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦è¨­å®šã‚’æŠ¼ã™
![](https://storage.googleapis.com/zenn-user-upload/vcj2lu0p4yfn8h2bt2welfslozbs)

1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ã‹ã‚‰æ¥ç¶šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ
![](https://storage.googleapis.com/zenn-user-upload/iwu1bwl087q72xwmgaw6uiz3eq8e)

1. æ¥ç¶šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ
äº‹å‰æº–å‚™ã¨ã—ã¦localã§ã‚‚ã„ã„ã®ã§Webã‚µãƒ¼ãƒã‚’ç«‹ã¡ä¸Šã’ã¦ãŠã
![](https://storage.googleapis.com/zenn-user-upload/q3k4dmamddqg5so1f45zkyr9kisa)

1. client_idã¨client_secretã®ç¢ºèª
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆãŒå®Œäº†ã€ã‚‚ã—ãã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸€è¦§ã‹ã‚‰ã€Œå‚ç…§ã€ã‚’æŠ¼ã™ã¨client_idã¨client_secretã‚’ç¢ºèªã§ãã‚‹
![](https://storage.googleapis.com/zenn-user-upload/i7qsmg7p0ame4f8qafybnj9hxdj1)


### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èªè¨¼
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã¤ã‘ã¦ä¸‹è¨˜ã«ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã€ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
https://login.salesforce.com/services/oauth2/authorize

|Key|Value|
|:--|:--|
|response_type|code|
|client_id|*****|
|redirect_uri|http%3A%2F%2Flocalhost|

SalesForceã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã®ã§è¨±å¯ã‚’ã™ã‚‹
![](https://storage.googleapis.com/zenn-user-upload/05gbirruylw5vl1q100tfhsgnd4v)

è¨±å¯ã™ã‚‹ã¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¦ã€URLã«code(æœ‰åŠ¹æ™‚é–“15åˆ†ç¨‹åº¦)ãŒè¿”ã£ã¦ãã‚‹
![](https://storage.googleapis.com/zenn-user-upload/3ldplfe7tdcq78igyezhmb2v0wur)

### refresh_tokenã®å–å¾—
èªè¨¼æ™‚ã«å–å¾—ã—ãŸcode&ãã®ä»–å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã¤ã‘ã¦ä¸‹è¨˜ã®URLã«ã€ŒPOSTã€ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
â€» ä¸‹è¨˜ç”»åƒã§ã¯postmanã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ãŒã€terminalã‹ã‚‰curlã§ã‚‚å–å¾—ã§ãã¾ã™ã€‚
https://login.salesforce.com/services/oauth2/token

|Key|Value|
|:--|:--|
|grant_type|authorization_code|
|code|*****|
|client_id|*****|
|client_secret|*****|
|redirect_uri|http://localhost|

![](https://storage.googleapis.com/zenn-user-upload/4to4dmcomhj20k6dxpua0u3fpb86)


ç„¡äº‹ã«refresh_tokenã‚’å–å¾—ã§ãã¾ã—ãŸã€‚
